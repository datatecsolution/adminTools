Index: src/main/java/net/datatecsolution/admin_tools/controlador/CtlOrdenVenta.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package net.datatecsolution.admin_tools.controlador;\r\n\r\n\r\nimport net.datatecsolution.admin_tools.modelo.*;\r\nimport net.datatecsolution.admin_tools.modelo.dao.*;\r\nimport net.datatecsolution.admin_tools.view.*;\r\n\r\nimport javax.swing.*;\r\nimport javax.swing.event.TableModelEvent;\r\nimport javax.swing.event.TableModelListener;\r\nimport java.awt.event.*;\r\nimport java.math.BigDecimal;\r\nimport java.sql.SQLException;\r\nimport java.util.List;\r\n\r\n\r\npublic class CtlOrdenVenta  implements ActionListener, MouseListener, TableModelListener, WindowListener, KeyListener  {\r\n\t\r\n\tprivate ViewOrdeneVenta view;\r\n\tprivate Factura myFactura=null;\r\n\tprivate FacturaDao facturaDao=null;//=new FacturaDao();\r\n\r\n\tprivate ClienteDao clienteDao=null;\r\n\tprivate Articulo myArticulo=null;\r\n\tprivate ArticuloDao myArticuloDao=null;\r\n\tprivate PrecioArticuloDao preciosDao=null;\r\n\tprivate CodBarraDao codBarraDao=null;\r\n\tprivate Cliente myCliente=null;\r\n\tprivate UsuarioDao myUsuarioDao;\r\n\tprivate InsumoDao insumoDao=null;\r\n\tprivate Caja cajaDefecto;\r\n\r\n\tprivate int filaPulsada=0;\r\n\tprivate boolean resultado=false;\r\n\t\r\n\tprivate int tipoView=1;\r\n\tprivate int netBuscar=0;\r\n\t\r\n\tprivate FacturaOrdenVentaDao facturaOrdenesDao;\r\n\tprivate DetalleFacturaOrdenDao detallesOrdenDao=null;\r\n\tprivate boolean unirCanItem=true;\r\n\t\r\n\tpublic CtlOrdenVenta(ViewOrdeneVenta v){\r\n\t\r\n\t\t\r\n\t\tview=v;\r\n\t\tview.conectarContralador(this);\r\n\t\t\r\n\t\t//se inicializan atributos de la factura\r\n\t\tmyFactura=new Factura();\r\n\t\tmyArticuloDao=new ArticuloDao();\r\n\t\tclienteDao=new ClienteDao();\r\n\t\tfacturaDao=new FacturaDao();\r\n\t\tpreciosDao=new PrecioArticuloDao();\r\n\t\tcodBarraDao=new CodBarraDao();\r\n\t\tthis.setEmptyView();\r\n\t\t\r\n\t\tfacturaOrdenesDao=new FacturaOrdenVentaDao();\r\n\t\tdetallesOrdenDao=new DetalleFacturaOrdenDao();\r\n\t\tmyUsuarioDao=new UsuarioDao();\r\n\t\tinsumoDao=new InsumoDao();\r\n\t\tcajaDefecto=new Caja(ConexionStatic.getUsuarioLogin().getCajaActiva());\r\n\t\t\r\n\t\tcargarFacturasPendientes(facturaOrdenesDao.facturasEnProceso());\r\n\t\tthis.tipoView=1;\r\n\r\n\t\tview.getBtnCobrar().setVisible(false);\r\n\t\tview.getBtnCierreCaja().setVisible(false);\r\n\r\n\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\r\n\t@Override\r\n\tpublic void actionPerformed(ActionEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tString comando=e.getActionCommand();\r\n\t\t\r\n\t\t//se filtra el comando para verificar que la accion se genero desde los botones de las facturas pendientes.\r\n\t\tif(AbstractJasperReports.isNumber(comando)){\r\n\t\t\tint numeroFactura=Integer.parseInt(comando);\r\n\t\t\t//si es un factura guardada\r\n\t\t\tif(numeroFactura>0){\r\n\t\t\t\r\n\t\t\t\tcargarFacturaPendiente(numeroFactura);\r\n\t\t\t}\r\n\t\t\t//si es una nueva factura\r\n\t\t\tif(numeroFactura==0){\r\n\t\t\t\tthis.tipoView=1;\r\n\t\t\t\tthis.view.getBtnGuardar().setEnabled(true);\r\n\t\t\t\tthis.view.getBtnActualizar().setEnabled(false);\r\n\t\t\t\t\r\n\t\t\t\t//view.getBtnsGuardador().setFactura(myFactura);\r\n\t\t\t\t\r\n\t\t\t\tsetEmptyView();\r\n\t\t\t\t\r\n\t\t\t\tview.getBtnsGuardador().deleteAll();\r\n\t\t\t\t\r\n\t\t\t\tcargarFacturasPendientes(facturaOrdenesDao.facturasEnProceso());\r\n\t\t\t}\r\n\t\t}\r\n\t\t//JOptionPane.showMessageDialog(view, \"paso de celdas\"+comando);\r\n\t\tswitch(comando){\r\n\t\t\r\n\t\tcase \"BUSCARARTICULO2\":\r\n\t\t\t//se comprueba que se ingreso un codigo de barra o que el articulo este nulo para poder buscar\r\n\t\t\tif(view.getTxtBuscar().getText().trim().length()!=0 || myArticulo==null){\r\n\r\n\r\n\t\t\t\tString busca=this.view.getTxtBuscar().getText();\r\n\r\n\t\t\t\tthis.myArticulo=this.myArticuloDao.buscarArticuloBarraCod(busca);\r\n\r\n\t\t\t\tif(myArticulo!=null){\r\n\r\n\t\t\t\t\t//activar para redondiar el precio de venta final\r\n\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPrecioRedondear()){\r\n\t\t\t\t\t\tmyArticulo.setPrecioVenta((int) Math.round(myArticulo.getPrecioVenta()));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//conseguir los precios del producto\r\n\t\t\t\t\tmyArticulo.setPreciosVenta(this.preciosDao.getPreciosArticuloSinCosto(myArticulo.getId()));\r\n\r\n\t\t\t\t\t//facturar sin tomar en cuenta el inventario\r\n\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isFacturarSinInventario()){\r\n\t\t\t\t\t\t//activar para redondiar el precio de venta final\r\n\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPrecioRedondear()){\r\n\t\t\t\t\t\t\tmyArticulo.setPrecioVenta((int) Math.round(myArticulo.getPrecioVenta()));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//si es un articulo tipo bien se puede agregar en cualquier caja\r\n\t\t\t\t\t\tif(myArticulo.getTipoArticulo()==1){\r\n\t\t\t\t\t\t\t//se agrega articulo a la tabla\r\n\t\t\t\t\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo);\r\n\t\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\t\t\t\tselectRowInset();\r\n\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t//se filtra para que la caja por defecto sera la unica que puede facturar servicios\r\n\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getCajaActiva().getCodigo()==this.cajaDefecto.getCodigo()){\r\n\t\t\t\t\t\t\t\t//se agrega articulo a la tabla\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo);\r\n\t\t\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\t\t\t\t\tselectRowInset();\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view,\"Solo la caja \"+cajaDefecto.getDescripcion() +\" puede facturar servicios.\",\"Error en articulo\",JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\tview.getTxtBuscar().setText(\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t} else{  //si esta activado la facturacion con inventario\r\n\r\n\t\t\t\t\t\t//se comprueba que exista el producto en el inventario\r\n\t\t\t\t\t\tdouble existencia=myArticuloDao.getExistencia(myArticulo.getId(), ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getId());\r\n\r\n\t\t\t\t\t\t//es necesario comprobar los inventarios de articulos\r\n\t\t\t\t\t\t//si es un bien se combrueba la existencia de ese articulo\r\n\t\t\t\t\t\tif(myArticulo.getTipoArticulo()==1){\r\n\r\n\t\t\t\t\t\t\t//se comprueba que exista el producto en el inventario\r\n\t\t\t\t\t\t\texistencia=myArticuloDao.getExistencia(myArticulo.getId(), ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getId());\r\n\r\n\t\t\t\t\t\t\tdouble cantidad=1;\r\n\r\n\t\t\t\t\t\t\tdouble buscarEnRequisicionCantidad=view.getModeloTabla().buscarCantidadPorArticulo(myArticulo);\r\n\r\n\t\t\t\t\t\t\tif(buscarEnRequisicionCantidad>0){\r\n\t\t\t\t\t\t\t\tcantidad=cantidad+buscarEnRequisicionCantidad;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(existencia>0.0 && cantidad<=existencia){\r\n\r\n\t\t\t\t\t\t\t\t//activar para redondiar el precio de venta final\r\n\t\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPrecioRedondear()){\r\n\t\t\t\t\t\t\t\t\tmyArticulo.setPrecioVenta((int) Math.round(myArticulo.getPrecioVenta()));\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t//se agrega articulo a la tabla\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo);\r\n\t\t\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\t\t\t\t\tselectRowInset();\r\n\r\n\t\t\t\t\t\t\t}else{//fin se la comprobacion de la existencia\r\n\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, myArticulo.getArticulo()+\" no tiene existencia en \"+ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getDescripcion(),\"Error en existencia\",JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\tview.getTxtBuscar().setText(\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{//si es un servicio que se necesita comprobar la existencia se busca sus insumos\r\n\r\n\t\t\t\t\t\t\t//se filtra para que la caja por defecto sera la unica que puede facturar servicios\r\n\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getCajaActiva().getCodigo()==this.cajaDefecto.getCodigo()){\r\n\r\n\t\t\t\t\t\t\t\t//comprobar la existencia de los insumos\r\n\t\t\t\t\t\t\t\tList<Insumo> insumos=this.insumoDao.buscarPorId(myArticulo.getId());\r\n\r\n\t\t\t\t\t\t\t\t//comprobamos de el articulo tenga insumos para hacer la busca de sus existencias\r\n\t\t\t\t\t\t\t\tif(insumos!=null && insumos.size()>0){\r\n\t\t\t\t\t\t\t\t\tboolean exist=false;\r\n\t\t\t\t\t\t\t\t\t//recoremos los insumos comprobando si tiene existencia\r\n\t\t\t\t\t\t\t\t\tfor(int xx=0;xx<insumos.size();xx++){\r\n\r\n\t\t\t\t\t\t\t\t\t\t//se comprueba que exista el insumo en el inventario\r\n\t\t\t\t\t\t\t\t\t\texistencia=myArticuloDao.getExistencia(insumos.get(xx).getArticulo().getId(), ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getId());\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(existencia>0.0 && existencia>=insumos.get(xx).getCantidad().doubleValue()){\r\n\t\t\t\t\t\t\t\t\t\t\t//se establece que esiste\r\n\t\t\t\t\t\t\t\t\t\t\texist=true;\r\n\t\t\t\t\t\t\t\t\t\t\t//activar para redondiar el precio de venta final\r\n\t\t\t\t\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPrecioRedondear()){\r\n\t\t\t\t\t\t\t\t\t\t\t\tmyArticulo.setPrecioVenta((int) Math.round(myArticulo.getPrecioVenta()));\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}else{//fin se la comprobacion de la existencia\r\n\t\t\t\t\t\t\t\t\t\t\texist=false;\r\n\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view,\"El insumo \"+ insumos.get(xx).getArticulo().getArticulo()+\" que pertence al servicio \"+myArticulo.getArticulo()+\" ,\\nno tiene existencia en \"+ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getDescripcion(),\"Error en existencia\",JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t\tview.getTxtBuscar().setText(\"\");\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}//sin del for que recore los insumos\r\n\r\n\t\t\t\t\t\t\t\t\t//se comprueba que todos los insumos tienen exitencia para agregar el servicio a la factura\r\n\t\t\t\t\t\t\t\t\tif(exist){\r\n\t\t\t\t\t\t\t\t\t\t//se agrega articulo a la tabla\r\n\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo);\r\n\r\n\t\t\t\t\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\r\n\t\t\t\t\t\t\t\t\t\tselectRowInset();\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}else{//sino tiene insumos el servicio se agrega directamente a la factura\r\n\t\t\t\t\t\t\t\t\t//se agrega articulo a la tabla\r\n\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo);\r\n\t\t\t\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\t\t\t\t\t\tselectRowInset();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view,\"Solo la caja \"+cajaDefecto.getDescripcion() +\" puede facturar servicios.\",\"Error en articulo\",JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\tview.getTxtBuscar().setText(\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}//sin del else para comprobar las existencia de los servicios\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tview.getTxtBuscar().setText(\"\");\r\n\r\n\t\t\t\t} else{//sino se encuentra ningun articulo se avisa al usuario\r\n\t\t\t\t\tJOptionPane.showMessageDialog(view, \"No se encontro el articulo\");\r\n\t\t\t\t\tview.getTxtBuscar().setText(\"\");\r\n\t\t\t\t\tview.getTxtBuscar().requestFocusInWindow();\r\n\t\t\t\t\tmyArticulo=null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\t\t\t\tnetBuscar=0;\r\n\t\t\tbreak;\r\n\t\tcase \"BUSCARCLIENTE\":\r\n\r\n\t\t\tmyCliente=null;\r\n\t\t\tmyCliente=clienteDao.buscarPorId(Integer.parseInt(this.view.getTxtIdcliente().getText()));\r\n\r\n\t\t\tif(myCliente!=null){\r\n\t\t\t\tthis.view.getTxtNombrecliente().setText(myCliente.getNombre());\r\n\t\t\t\tthis.view.getTxtRtn().setText(myCliente.getRtn());\r\n\t\t\t}else{\r\n\r\n\t\t\t\tJOptionPane.showMessageDialog(view, \"Cliente no encontrado\");\r\n\t\t\t\tthis.view.getTxtIdcliente().setText(\"1\");\r\n\t\t\t\tthis.view.getTxtNombrecliente().setText(\"Cliente Normal\");\r\n\t\t\t}\r\n\t\t\t//96995768\r\n\t\t\tbreak;\r\n\t\tcase \"ACTUALIZAR\":\r\n\t\t\tthis.actualizar();\r\n\t\t\tbreak;\r\n\t\tcase \"BUSCARARTICULO\":\r\n\t\t\t//se verfica si esta activo la busqueda de articulo por descripcion\r\n\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isActivarBusquedaFacturacion())\r\n\t\t\t{\r\n\t\t\t\tthis.buscarArticulo();\r\n\t\t\t}\r\n\t\tbreak;\r\n\t\t\r\n\t\tcase \"CERRAR\":\r\n\t\t\tthis.salir();\r\n\t\tbreak;\r\n\t\tcase \"BUSCARCLIENTES\":\r\n\t\t\tthis.buscarCliente();\r\n\t\t\tbreak;\r\n\t\tcase \"COBRAR\":\r\n\t\t\t//this.cobrar();\r\n\t\t\tbreak;\r\n\t\tcase \"GUARDAR\":\r\n\t\t\tthis.guardar();\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase \"CIERRECAJA\":\r\n\t\t\t//this.cierreCaja();\r\n\t\t\tbreak;\r\n\t\tcase \"COTIZACION\":\r\n\t\t\t//this.showPendientes();\r\n\t\t\t//JOptionPane.showMessageDialog(view, \"Cliente no encontrado\");\r\n\t\t\tguardarCotizacion();\r\n\t\t\tbreak;\r\n\t\tcase \"GET_COTIZACIONES\":\r\n\t\t\tshowPendientes();\r\n\t\t\tbreak;\r\n\t\tcase \"ELIMINARPENDIENTE\":\r\n\t\t\tint idFacturaTemporal2=view.getBtnsGuardador().getFacturaSeleted().getIdFactura();\r\n\r\n\t\t\tFactura eliminarTem=new Factura();\r\n\t\t\teliminarTem.setIdFactura(idFacturaTemporal2);\r\n\r\n\r\n\t\t\tJPasswordField pf = new JPasswordField();\r\n\t\t\tint action =JOptionPane.showConfirmDialog(view,\"Desea eliminar la orden de \"+view.getBtnsGuardador().getFacturaSeleted().getCliente().getNombre()+\" ?\",\"Confirmacion\",JOptionPane.OK_CANCEL_OPTION);\r\n\t\t\t//JOptionPane.showMessageDialog(view,\"La accion es: \"+action);\r\n\t\t\tif(action == 0){\r\n\r\n\r\n\r\n\t\t\t\tthis.facturaOrdenesDao.eliminar(eliminarTem);\r\n\r\n\t\t\t\tthis.tipoView=1;\r\n\t\t\t\tthis.view.getBtnGuardar().setEnabled(true);\r\n\t\t\t\tthis.view.getBtnActualizar().setEnabled(false);\r\n\r\n\t\t\t\t//view.getBtnsGuardador().setFactura(myFactura);\r\n\r\n\t\t\t\t//setEmptyView();\r\n\t\t\t\tsetEmptyView();\r\n\r\n\t\t\t\tview.getBtnsGuardador().deleteAll();\r\n\r\n\t\t\t\tcargarFacturasPendientes(facturaOrdenesDao.facturasEnProceso());\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n\r\n\tprivate void guardarCotizacion() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t//s\r\n\t\tsetFactura();\r\n\t\tif(validar()){\r\n\t\t\t\tCotizacionDao cotizacioDao=new CotizacionDao();\r\n\t\t\t\t//sf\r\n\t\t\t\tboolean resultado=cotizacioDao.registrar(myFactura);\r\n\t\t\t\t\r\n\t\t\t\tif(resultado){\r\n\t\t\t\t\t\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t/*this.view.setVisible(false);\r\n\t\t\t\t\t\tthis.view.dispose();*/\r\n\t\t\t\t\t\t//AbstractJasperReports.createReportFactura( conexion.getPoolConexion().getConnection(), \"Factura_Saint_Paul.jasper\",myFactura.getIdFactura() );\r\n\t\t\t\t\t\tAbstractJasperReports.crearReporteCotizacion(ConexionStatic.getPoolConexion().getConnection(), myFactura.getIdFactura());\r\n\t\t\t\t\t\tAbstractJasperReports.showViewer(view);\r\n\t\t\t\t\t\t//AbstractJasperReports.imprimierFactura();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//myFactura=null;\r\n\t\t\t\t\t\tsetEmptyView();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//si la view es de actualizacion al cobrar se cierra la view\r\n\t\t\t\t\t\tif(this.tipoView==2){//dfsfda\r\n\t\t\t\t\t\t\t//myFactura=null;\r\n\t\t\t\t\t\t\tthis.tipoView=1;\r\n\t\t\t\t\t\t\tthis.view.getBtnGuardar().setEnabled(true);\r\n\t\t\t\t\t\t\tthis.view.getBtnActualizar().setEnabled(false);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t//\tthis.facturaDao.EliminarTemp(idFacturaTemporal);\r\n\t\t\t\t\t\t\tsetEmptyView();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tview.getBtnsGuardador().deleteAll();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcargarFacturasPendientes(facturaOrdenesDao.facturasEnProceso());\r\n\t\t\t\t\t\t\t//view.setVisible(false);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//myFactura.\r\n\t\t\t\t\t} catch (SQLException e) {\r\n\t\t\t\t\t\t// TODO Auto-generated catch block\r\n\t\t\t\t\t\te.printStackTrace();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//JOptionPane.showMessageDialog(view, \"Se guardao la cotizacion con exito\", \"Cotizacion\", JOptionPane.INFORMATION_MESSAGE);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tJOptionPane.showMessageDialog(view, \"Error al guardar la cotizacion\", \"Error al guardar\", JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tprivate void cargarFacturaPendiente(int numeroFactura) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tFactura fact=view.getBtnsGuardador().buscarFactura(numeroFactura);\r\n\t\tthis.myFactura=fact;\r\n\t\t\r\n\t\tmyFactura.setDetalles(detallesOrdenDao.detallesFacturaPendiente(numeroFactura));\r\n\t\t\r\n\t\tcargarFacturaView();\r\n\t\tthis.view.getBtnGuardar().setEnabled(false);\r\n\t\tthis.view.getBtnActualizar().setEnabled(true);\r\n\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\ttipoView=2;\r\n\t}\r\n\r\n\tprivate void setFactura(){\r\n\t\t\r\n\t\t//sino se ingreso un cliente en particular que coge el cliente por defecto\r\n\t\tif(myCliente==null){\r\n\t\t\tmyCliente=new Cliente();\r\n\t\t\tmyCliente.setId(Integer.parseInt(this.view.getTxtIdcliente().getText()));\r\n\t\t\tmyCliente.setNombre(this.view.getTxtNombrecliente().getText());\r\n\t\t\tmyCliente.setRtn(view.getTxtRtn().getText());\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif(this.view.getRdbtnContado().isSelected()){\r\n\t\t\tmyFactura.setTipoFactura(1);\r\n\t\t\tmyFactura.setEstadoPago(1);\r\n\t\t}\r\n\t\t\r\n\t\tif(this.view.getRdbtnCredito().isSelected()){\r\n\t\t\tmyFactura.setTipoFactura(2);\r\n\t\t\tmyFactura.setEstadoPago(0);\r\n\t\t}\r\n\t\t\r\n\t\tmyFactura.setCliente(myCliente);\r\n\t\tmyFactura.setDetalles(this.view.getModeloTabla().getDetalles());\r\n\t\tmyFactura.setFecha(facturaDao.getFechaSistema());\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void mouseClicked(MouseEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void mousePressed(MouseEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tcheckForTriggerEvent( e ); // comprueba el desencadenador\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void mouseReleased(MouseEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tcheckForTriggerEvent( e ); // comprueba el desencadenador\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void mouseEntered(MouseEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void mouseExited(MouseEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\tpublic void check(MouseEvent e)\r\n\t{ \r\n\t\tif (e.isPopupTrigger()) { //if the event shows the menu \r\n\t\t\t//this.view.getListCodigos().setSelectedIndex(this.view.getListCodigos().locationToIndex(e.getPoint())); //select the item \r\n\t\t\t//menuContextual.show(listCodigos, e.getX(), e.getY()); //and show the menu \r\n\t\t} \r\n\t\t\r\n\t\t\r\n\t}\r\n\t// determina si el evento debe desencadenar el menï¿½ contextual\r\n\tprivate void checkForTriggerEvent( MouseEvent evento )\r\n\t{\r\n\t\tif ( evento.isPopupTrigger() ){\r\n\t\t\t\r\n\t\t\t//se recoge el boton que produjo en evento\r\n\t\t\tJToggleButton even= (JToggleButton) evento.getComponent();\r\n\t\t\teven.setSelected(true);//se selecciona\r\n\t\t\t\r\n\t\t\t// se consigue el codigo de factura del boton seleccionado\r\n\t\t\tint idFacturaTemporal=view.getBtnsGuardador().getFacturaSeleted().getIdFactura();\r\n\t\t\t//se carga la factura en la view.\r\n\t\t\tthis.cargarFacturaPendiente(idFacturaTemporal);\r\n\t\t\tthis.view.getMenuContextual().show(evento.getComponent(), evento.getX(), evento.getY() );\r\n\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t} // fin del metodo checkForTriggerEvent\r\n\r\n\t@Override\r\n\tpublic void tableChanged(TableModelEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t\tint colum=e.getColumn();\r\n\t\tint row=e.getFirstRow();\r\n\t\t//JOptionPane.showMessageDialog(view, myArticulo);\r\n\t\t//JOptionPane.showMessageDialog(view, \"paso de celdas\");\r\n\t\tswitch(e.getType()){\r\n\t\t\r\n\t\t\t\r\n\t\t\r\n\t\t\tcase TableModelEvent.UPDATE:\r\n\t\t\t\t\r\n\t\t\t\t//Se recoge el id de la fila marcada\r\n\t\t        int identificador=0; \r\n\t\t\t\t\r\n\t\t\t\t//se ingreso un id o codigo de barra en la tabla\r\n\t\t\t\tif(colum==0){\r\n\t\t\t\t\t\r\n\t\t\t\t\tidentificador=(int)this.view.getModeloTabla().getValueAt(row, 0);\r\n\t\t\t        myArticulo=this.view.getModeloTabla().getDetalle(row).getArticulo();\r\n\t\t\t        myArticulo.setCodigoBarra(codBarraDao.getCodArticulo(myArticulo.getId()));\r\n\t\t\t\t\t\r\n\t\t\t        //se ingreso un codigo de barra y si el articulo en la bd \r\n\t\t\t        if(myArticulo.getId()==-2){\r\n\t\t\t\t\t\tString cod=this.view.getModeloTabla().getDetalle(row).getArticulo().getCodBarra().get(0).getCodigoBarra();\r\n\t\t\t\t\t\tthis.myArticulo=this.myArticuloDao.buscarArticuloBarraCod(cod);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}else{//sino se ingreso un codigo de barra se busca por id de articulo\r\n\t\t\t\t\t\tthis.myArticulo=this.myArticuloDao.buscarArticulo(identificador);\r\n\t\t\t\t\t\tmyArticulo.setCodigoBarra(codBarraDao.getCodArticulo(myArticulo.getId()));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//si se encuentra  el articulo por codigo de barra o por id se calcula los totales y se agrega \r\n\t\t\t\t\tif(myArticulo!=null){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//se estable en articulo en la tabla\r\n\t\t\t\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo, row);\r\n\t\t\t\t\t\t//se calcula los totales\r\n\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tboolean toggle = false;\r\n\t\t\t\t\t    boolean extend = false;\r\n\t\t\t\t\t    this.view.getTableDetalle().changeSelection(row, 0, toggle, extend);\r\n\t\t\t\t\t    this.view.getTableDetalle().changeSelection(row, colum, toggle, extend);\r\n\t\t\t\t\t    this.view.getTableDetalle().addColumnSelectionInterval(3, 3);\r\n\t\t\t\t\t    \r\n\t\t\t\t\t    \r\n\t\t\t\t\t    \r\n\t\t\t\t\t\t//se agrega otra fila en la tabla\r\n\t\t\t\t\t\t//this.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}else{//si no se encuentra\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"No se encuentra el articulo\");\r\n\t\t\t\t\t\t//sino se encuentra se estable un id de -1 para que sea eliminado el articulo en la tabla\r\n\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(row).getArticulo().setId(-1);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//se agrega la nueva fila de la tabla\r\n\t\t\t\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// se vuelve a calcular los totales\r\n\t\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t//se cambia el precio en la tabla\r\n\t\t\t\tif(colum==1){\r\n\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\tview.getTxtBuscar().requestFocusInWindow();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//se cambia la cantidad en la tabla\r\n\t\t\t\tif(colum==2){\r\n\t\t\t\t\t\r\n\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\tview.getTxtBuscar().requestFocusInWindow();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//se agrego un descuento a la tabla\r\n\t\t\t\tif(colum==5){\r\n\t\t\t\t\tcalcularTotales();\r\n\t\t\t\t\tview.getTxtBuscar().requestFocusInWindow();\r\n\t\t\t\t\t//JOptionPane.showMessageDialog(view, \"Modifico el Descuento \"+this.view.getModeloTabla().getDetalle(row).getDescuentoItem().setScale(2, BigDecimal.ROUND_HALF_EVEN).doubleValue());\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//view.getTxtBuscar().requestFocusInWindow();\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic boolean esValido(Character caracter)\r\n    {\r\n        char c = caracter.charValue();\r\n        return Character.isLetter(c) //si es letra\r\n                || c == ' ' //o un espacio\r\n                || c == 8 //o backspace\r\n                || (Character.isDigit(c));\r\n    }\r\n\t\r\n\t\r\n\tpublic void calcularTotales(){\r\n\t\t\r\n\t\t//se establecen los totales en cero\r\n\t\tthis.myFactura.resetTotales();\r\n\t\t\r\n\t\tfor(int x=0; x<this.view.getModeloTabla().getDetalles().size();x++){\r\n\t\t\t\r\n\t\t\tDetalleFactura detalle=this.view.getModeloTabla().getDetalle(x);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif(detalle.getArticulo().getId()!=-1)\r\n\t\t\t\tif(detalle.getCantidad().doubleValue()!=0 && detalle.getArticulo().getPrecioVenta()!=0){\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se obtien la cantidad y el precio de compra por unidad\r\n\t\t\t\t\tBigDecimal cantidad=detalle.getCantidad();\r\n\t\t\t\t\tBigDecimal precioVenta= new BigDecimal(detalle.getArticulo().getPrecioVenta());\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se calcula el total del item\r\n\t\t\t\t\tBigDecimal totalItem=cantidad.multiply(precioVenta);\r\n\t\t\t\t\t\r\n\t\t\t\t\tBigDecimal des =detalle.getDescuentoItem();\r\n\t\t\t\t\t\r\n\t\t\t\t\t//double desc=detalle.getDescuento()/100;\r\n\t\t\t\t\t\r\n\t\t\t\t\t//BigDecimal des=totalItem.multiply(new BigDecimal(desc));\r\n\t\t\t\t\t\r\n\t\t\t\t\t//detalle.setDescuentoItem(des.setScale(0, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\r\n\t\t\t\t\ttotalItem=totalItem.subtract(des.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t//int desc=detalle.getDescuento();\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se obtiene el impuesto del articulo \r\n\t\t\t\t\tBigDecimal porcentaImpuesto =new BigDecimal(detalle.getArticulo().getImpuestoObj().getPorcentaje());\r\n\t\t\t\t\tBigDecimal porImpuesto=new BigDecimal(0);\r\n\t\t\t\t\tporImpuesto=porcentaImpuesto.divide(new BigDecimal(100));\r\n\t\t\t\t\tporImpuesto=porImpuesto.add(new BigDecimal(1));\r\n\t\t\t\t\t\t\t//new BigDecimal(((Double.parseDouble(detalle.getArticulo().getImpuestoObj().getPorcentaje())  )/100)+1);\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se calcula el total sin  el impuesto;\r\n\t\t\t\t\tBigDecimal totalsiniva= new BigDecimal(\"0.0\");\r\n\t\t\t\t\ttotalsiniva=totalItem.divide(porImpuesto,2,BigDecimal.ROUND_HALF_EVEN);//.divide(porImpuesto);// (totalItem)/(porcentaImpuesto);\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se calcula el total de impuesto del item\r\n\t\t\t\t\tBigDecimal impuestoItem=totalItem.subtract(totalsiniva);//-totalsiniva;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se estable el total y impuesto en el modelo\r\n\t\t\t\t\tmyFactura.setTotal(totalItem.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(porcentaImpuesto.intValue()==0){\r\n\t\t\t\t\t\tmyFactura.setSubTotalExcento(totalsiniva.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t}else\r\n\t\t\t\t\t\tif(porcentaImpuesto.intValue()==15){\r\n\t\t\t\t\t\t\tmyFactura.setTotalImpuesto(impuestoItem.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t\tmyFactura.setSubTotal15(totalsiniva.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t}else\r\n\t\t\t\t\t\t\tif(porcentaImpuesto.intValue()==18){\r\n\t\t\t\t\t\t\t\tmyFactura.setTotalImpuesto18(impuestoItem.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t\t\tmyFactura.setSubTotal18(totalsiniva.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se calcuala el total del impuesto de los articulo que son servicios de turismo\r\n\t\t\t\t\tif(detalle.getArticulo().getTipoArticulo()==3){\r\n\t\t\t\t\t\tBigDecimal totalOtrosImp= new BigDecimal(\"0.0\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttotalOtrosImp=totalsiniva.multiply(new BigDecimal(0.04));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tmyFactura.setTotalOtrosImpuesto(totalOtrosImp.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\tmyFactura.setTotal(totalOtrosImp.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tmyFactura.setSubTotal(totalsiniva.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t//myFactura.getDetalles().add(detalle);\r\n\t\t\t\t\tmyFactura.setTotalDescuento(detalle.getDescuentoItem().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\r\n\t\t\t\t\tdetalle.setSubTotal(totalsiniva.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\tdetalle.setImpuesto(impuestoItem.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t//myFactura.getDetalles()\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se establece en la y el impuesto en el item de la vista\r\n\t\t\t\t\t//detalle.setImpuesto(impuesto2.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\tdetalle.setTotal(totalItem.setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\r\n\t\t\t\t\t//se establece el total e impuesto en el vista\r\n\t\t\t\t\tthis.view.getTxtTotal().setText(\"\"+myFactura.getTotal().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\tthis.view.getTxtImpuesto().setText(\"\"+myFactura.getTotalImpuesto().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\tthis.view.getTxtImpuesto18().setText(\"\"+myFactura.getTotalImpuesto18().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\tthis.view.getTxtSubtotal().setText(\"\"+myFactura.getSubTotal().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\tthis.view.getTxtDescuento().setText(\"\"+myFactura.getTotalDescuento().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\r\n\t\t\t\t\tview.getModeloTabla().fireTableDataChanged();\r\n\t\t\t\t\tthis.selectRowInset();\r\n\t\t\t\t\t\r\n\t\t\t\t\tview.getTxtBuscar().requestFocusInWindow();\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//this.view.getModelo().fireTableDataChanged();\r\n\t\t\t\t}//fin del if\r\n\t\t\t\r\n\t\t}//fin del for\r\n\t\t}\r\n\r\n\r\n\t@Override\r\n\tpublic void keyTyped(KeyEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void keyPressed(KeyEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\r\n\t\t\r\n\t\t//Recoger que fila se ha pulsadao en la tabla\r\n\t\tfilaPulsada = this.view.getTableDetalle().getSelectedRow();\r\n\t\t\r\n\t\t\tswitch(e.getKeyCode()){\r\n\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F1:\r\n\t\t\t\t\t\t//se verfica si esta activo la busqueda de articulo por descripcion\r\n\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isActivarBusquedaFacturacion())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbuscarArticulo();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F2:\r\n\t\t\t\t\t\t//cobrar();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F3:\r\n\t\t\t\t\t\t\tbuscarCliente();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F4:\r\n\t\t\t\t\t\tthis.guardar();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F5:\r\n\t\t\t\t\t\tguardarCotizacion();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F6:\r\n\t\t\t\t\t\t//cierreCaja();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F7:\r\n\r\n\t\t\t\t\t\tdouble maxDescuento=5;\r\n\t\t\t\t\t\t//configuracion del panel descuento\r\n\t\t\t\t\t\tJPanel panelDescuento=new JPanel();\r\n\t\t\t\t\t\tpanelDescuento.setLayout(new BoxLayout(panelDescuento, BoxLayout.Y_AXIS));\r\n\r\n\t\t\t\t\t\tJLabel etiqueta =new JLabel(\"Escriba el descuento\");\r\n\t\t\t\t\t\tpanelDescuento.add(etiqueta);\r\n\r\n\t\t\t\t\t\tJTextField descuento=new JTextField(15);\r\n\t\t\t\t\t\tpanelDescuento.add(descuento);\r\n\t\t\t\t\t\t//dfs\r\n\t\t\t\t\t\tJCheckBox   rememberChk = new JCheckBox(\"Agregar descuento a todos los items?\");\r\n\t\t\t\t\t\tpanelDescuento.add(rememberChk);\r\n\r\n\t\t\t\t\t\tdescuento.requestFocusInWindow();\r\n\t\t\t\t\t\t//sdfsdf\r\n\r\n\r\n\r\n\t\t\t\t\t\t//si es necesario el password para el descuento\r\n\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPwdDescuento()){\r\n\t\t\t\t\t\t\tString pwd=getPassword();\r\n\t\t\t\t\t\t\tif(pwd!=null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//comprabacion del permiso administrativo\r\n\t\t\t\t\t\t\t\tif(myUsuarioDao.comprobarAdmin(pwd)){\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t//si el descuento es un porcentaje\r\n\t\t\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isDescPorcentaje()){\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tetiqueta.setText(\"Escriba el porcentaje(%) de descuento 1-5%\");\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//se muestra la pantalla para solitar el descuento\r\n\t\t\t\t\t\t\t\t\t\t\tJOptionPane pane = new JOptionPane(panelDescuento, JOptionPane.QUESTION_MESSAGE, JOptionPane.OK_CANCEL_OPTION) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\t\t\t\t\t\t\tpublic void selectInitialValue() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdescuento.requestFocusInWindow();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\tpane.createDialog(view, \"Descuento\").setVisible(true);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tString seleccionadoDescuento=descuento.getText();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tboolean aplicarTodo = rememberChk.isSelected();\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(seleccionadoDescuento)){\r\n\t\t\t\t\t\t\t\t\t\t\t\tdouble bdDescuento=Double.parseDouble(seleccionadoDescuento);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(bdDescuento<=maxDescuento){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(aplicarTodo==false){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal cantidad=this.view.getModeloTabla().getDetalle(filaPulsada).getCantidad();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal precioVenta= new BigDecimal(view.getModeloTabla().getDetalle(filaPulsada).getArticulo().getPrecioVenta());\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//se calcula el total del item\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal totalItem=cantidad.multiply(precioVenta);\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdouble desc=bdDescuento/100;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal des=totalItem.multiply(new BigDecimal(desc));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setDescuentoItem(des.setScale(0, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//se recorren los item de la factura aplicando el descuento\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfor(int xx=0;xx<view.getModeloTabla().getDetalles().size();xx++){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDetalleFactura detalle=this.view.getModeloTabla().getDetalle(xx);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//dfsdf\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getArticulo().getId()!=-1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getCantidad().doubleValue()!=0 && detalle.getArticulo().getPrecioVenta()!=0){\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal cantidad=detalle.getCantidad();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal precioVenta= new BigDecimal(detalle.getArticulo().getPrecioVenta());\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//se calcula el total del item\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal totalItem=cantidad.multiply(precioVenta);\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdouble desc=bdDescuento/100;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal des=totalItem.multiply(new BigDecimal(desc));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetalle.setDescuentoItem(des.setScale(0, BigDecimal.ROUND_HALF_EVEN));\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}//fin del descuento por item o todo\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//this.view.getModeloTabla().getDetalle(filaPulsada).setDescuento(bdDescuento);//.getArticulo().setPrecioVenta(new Double(entrada));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"No puede otorgar un descuento mayo del 5%\", \"Error\", JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"El descuento debe ser un numero\", \"Error\", JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}else{//sino es un porcentaje\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\t\t\t\t//String entrada=JOptionPane.showInputDialog(\"Escriba el descuento\");\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tetiqueta.setText(\"Escriba el descuento\");\r\n\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog ( view,  panelDescuento,  \"Descuento\",JOptionPane.INFORMATION_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t\t//String seleccionadoDescuento=JOptionPane.showInputDialog(view,\"Escriba el porcentaje(%) de descuento 1-55%\",JOptionPane.QUESTION_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t\tString entrada=descuento.getText();\r\n\t\t\t\t\t\t\t\t\t\t\tboolean aplicarTodo = rememberChk.isSelected();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(entrada)){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(aplicarTodo==false){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setDescuentoItem(new BigDecimal(entrada));//.getArticulo().setPrecioVenta(new Double(entrada));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//se recorren los item de la factura aplicando el descuento\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor(int xx=0;xx<view.getModeloTabla().getDetalles().size();xx++){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tDetalleFactura detalle=this.view.getModeloTabla().getDetalle(xx);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//dfsdf\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getArticulo().getId()!=-1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getCantidad().doubleValue()!=0 && detalle.getArticulo().getPrecioVenta()!=0){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetalle.setDescuentoItem(new BigDecimal(entrada));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}//fin del descuento no porjentaje\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t}//fin comprobacion del usuario admin\r\n\t\t\t\t\t\t\t}//fin de la captura del pwd del usuario\r\n\r\n\t\t\t\t\t\t}else{\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t//si el descuento es un porcentaje\r\n\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isDescPorcentaje()){\r\n\r\n\r\n\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\r\n\t\t\t\t\t\t\t\t\tetiqueta.setText(\"Escriba el porcentaje(%) de descuento 1-5%\");\r\n\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog ( view,  panelDescuento,  \"Descuento\",JOptionPane.INFORMATION_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t//String seleccionadoDescuento=JOptionPane.showInputDialog(view,\"Escriba el porcentaje(%) de descuento 1-55%\",JOptionPane.QUESTION_MESSAGE);\r\n\t\t\t\t\t\t\t\t\tString seleccionadoDescuento=descuento.getText();\r\n\r\n\t\t\t\t\t\t\t\t\tboolean aplicarTodo = rememberChk.isSelected();\r\n\r\n\r\n\t\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(seleccionadoDescuento)){\r\n\t\t\t\t\t\t\t\t\t\tdouble bdDescuento=Double.parseDouble(seleccionadoDescuento);\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(bdDescuento<=maxDescuento){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif(aplicarTodo==false){\r\n\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal cantidad=this.view.getModeloTabla().getDetalle(filaPulsada).getCantidad();\r\n\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal precioVenta= new BigDecimal(view.getModeloTabla().getDetalle(filaPulsada).getArticulo().getPrecioVenta());\r\n\t\t\t\t\t\t\t\t\t\t\t\t//se calcula el total del item\r\n\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal totalItem=cantidad.multiply(precioVenta);\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tdouble desc=bdDescuento/100;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal des=totalItem.multiply(new BigDecimal(desc));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setDescuentoItem(des.setScale(0, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//se recorren los item de la factura aplicando el descuento\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor(int xx=0;xx<view.getModeloTabla().getDetalles().size();xx++){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tDetalleFactura detalle=this.view.getModeloTabla().getDetalle(xx);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//dfsdf\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getArticulo().getId()!=-1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getCantidad().doubleValue()!=0 && detalle.getArticulo().getPrecioVenta()!=0){\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal cantidad=detalle.getCantidad();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal precioVenta= new BigDecimal(detalle.getArticulo().getPrecioVenta());\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//se calcula el total del item\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal totalItem=cantidad.multiply(precioVenta);\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdouble desc=bdDescuento/100;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal des=totalItem.multiply(new BigDecimal(desc));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetalle.setDescuentoItem(des.setScale(0, BigDecimal.ROUND_HALF_EVEN));\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}//fin del descuento por item o todo\r\n\t\t\t\t\t\t\t\t\t\t\t//this.view.getModeloTabla().getDetalle(filaPulsada).setDescuento(bdDescuento);//.getArticulo().setPrecioVenta(new Double(entrada));\r\n\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"No puede otorgar un descuento mayo del 5%\", \"Error\", JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"El descuento debe ser un numero\", \"Error\", JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}else{//sino es un porcentaje\r\n\r\n\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\t\t//String entrada=JOptionPane.showInputDialog(\"Escriba el descuento\");\r\n\r\n\t\t\t\t\t\t\t\t\tetiqueta.setText(\"Escriba el descuento\");\r\n\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog ( view,  panelDescuento,  \"Descuento\",JOptionPane.INFORMATION_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t//String seleccionadoDescuento=JOptionPane.showInputDialog(view,\"Escriba el porcentaje(%) de descuento 1-55%\",JOptionPane.QUESTION_MESSAGE);\r\n\t\t\t\t\t\t\t\t\tString entrada=descuento.getText();\r\n\t\t\t\t\t\t\t\t\tboolean aplicarTodo = rememberChk.isSelected();\r\n\r\n\t\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(entrada)){\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(aplicarTodo==false){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setDescuentoItem(new BigDecimal(entrada));//.getArticulo().setPrecioVenta(new Double(entrada));\r\n\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//se recorren los item de la factura aplicando el descuento\r\n\t\t\t\t\t\t\t\t\t\t\tfor(int xx=0;xx<view.getModeloTabla().getDetalles().size();xx++){\r\n\t\t\t\t\t\t\t\t\t\t\t\tDetalleFactura detalle=this.view.getModeloTabla().getDetalle(xx);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//dfsdf\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getArticulo().getId()!=-1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(detalle.getCantidad().doubleValue()!=0 && detalle.getArticulo().getPrecioVenta()!=0){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetalle.setDescuentoItem(new BigDecimal(entrada));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}//fin del descuento no porjentaje\r\n\r\n\r\n\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F8:\r\n\r\n\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPwdPrecio()){\r\n\r\n\t\t\t\t\t\t\tString pwd=getPassword();\r\n\t\t\t\t\t\t\tif(pwd!=null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//String pwd=new String(pf.getPassword());\r\n\t\t\t\t\t\t\t\t//comprabacion del permiso administrativo\r\n\t\t\t\t\t\t\t\tif(myUsuarioDao.comprobarAdmin(pwd)){\r\n\r\n\t\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\t\t\tString entrada=JOptionPane.showInputDialog(\"Escriba el precio\");\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(entrada)){\r\n\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).getArticulo().setPrecioVenta(new Double(entrada));\r\n\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\tString entrada=JOptionPane.showInputDialog(view,\"Escriba el precio\");\r\n\r\n\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(entrada)){\r\n\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).getArticulo().setPrecioVenta(new Double(entrada));\r\n\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyEvent.VK_F9:\r\n\t\t\t\t\t\tif(filaPulsada>=0){\r\n\r\n\r\n\t\t\t\t\t\t\tString entrada=JOptionPane.showInputDialog(view,\"Escriba la candidad\");\r\n\r\n\t\t\t\t\t\t\t//se verfica en la configuracion si se puede facturar sin inventario\r\n\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isFacturarSinInventario())\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//se registra la cantida en la entrada del usuario\r\n\t\t\t\t\t\t\t\tBigDecimal cantidadSaldoItem=new BigDecimal(entrada);\r\n\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setCantidad(cantidadSaldoItem);\r\n\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\r\n\t\t\t\t\t\t\t}else{//se verfica en la configuracion si se puede facturar con inventario\r\n\r\n\t\t\t\t\t\t\t\tif(AbstractJasperReports.isNumberReal(entrada)){\r\n\t\t\t\t\t\t\t\t\t//si es un bien se procede de esta manera\r\n\t\t\t\t\t\t\t\t\tif(myArticulo.getTipoArticulo()==1){\r\n\t\t\t\t\t\t\t\t\t\t//se extre la exista del producto en el inventario\r\n\t\t\t\t\t\t\t\t\t\tdouble existencia=myArticuloDao.getExistencia(myArticulo.getId(), ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getId());\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t//se registra la cantida en la entrada del usuario\r\n\t\t\t\t\t\t\t\t\t\tBigDecimal cantidadSaldoItem=new BigDecimal(entrada);\r\n\r\n\t\t\t\t\t\t\t\t\t\t//se recoge la nueva cantidad a colocar en el item\r\n\t\t\t\t\t\t\t\t\t\tdouble cantidad=cantidadSaldoItem.doubleValue();\r\n\r\n\t\t\t\t\t\t\t\t\t\t//se establece la nueva cantidad\r\n\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setCantidad(cantidadSaldoItem);\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\t//se busca el articulo en la factura las cantidades del mismo articulo\r\n\t\t\t\t\t\t\t\t\t\tdouble buscarEnRequisicionCantidad=view.getModeloTabla().buscarCantidadPorArticulo(myArticulo);\r\n\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(existencia>0.0 && cantidad<=existencia) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"No se puede requerir la cantidad de \"+cantidadSaldoItem.setScale(0, BigDecimal.ROUND_HALF_EVEN).doubleValue()+\" del articulo en la bodega \"+ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getDescripcion());\r\n\t\t\t\t\t\t\t\t\t\t\tview.getModeloTabla().eliminarDetalle(filaPulsada);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}else{//si es un servicio se procede a buscar sus insumos y si es posible facturar\r\n\r\n\t\t\t\t\t\t\t\t\t\t//la variable para la existecia en el kardex\r\n\t\t\t\t\t\t\t\t\t\tdouble existencia=0;\r\n\r\n\t\t\t\t\t\t\t\t\t\t//se registra la cantida en la entrada del usuario\r\n\t\t\t\t\t\t\t\t\t\tBigDecimal cantidadSaldoItem=new BigDecimal(entrada);\r\n\r\n\t\t\t\t\t\t\t\t\t\t//comprobar la existencia de los insumos\r\n\t\t\t\t\t\t\t\t\t\tList<Insumo> insumos=this.insumoDao.buscarPorId(myArticulo.getId());\r\n\r\n\t\t\t\t\t\t\t\t\t\t//comprobamos de el articulo tenga insumos para hacer la busca de sus existencias\r\n\t\t\t\t\t\t\t\t\t\tif(insumos!=null && insumos.size()>0){\r\n\t\t\t\t\t\t\t\t\t\t\tboolean exist=false;\r\n\t\t\t\t\t\t\t\t\t\t\t//recoremos los insumos comprobando si tiene existencia\r\n\t\t\t\t\t\t\t\t\t\t\tfor(int xx=0;xx<insumos.size();xx++){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//se comprueba que exista el insumo en el inventario\r\n\t\t\t\t\t\t\t\t\t\t\t\texistencia=myArticuloDao.getExistencia(insumos.get(xx).getArticulo().getId(), ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getId());\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tBigDecimal cantRequerida=cantidadSaldoItem.multiply(insumos.get(xx).getCantidad());\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(existencia>0.0 && existencia>=cantRequerida.doubleValue()){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//se establece que esiste\r\n\t\t\t\t\t\t\t\t\t\t\t\t\texist=true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}else{//fin se la comprobacion de la existencia\r\n\t\t\t\t\t\t\t\t\t\t\t\t\texist=false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view,\"El insumo \"+ insumos.get(xx).getArticulo().getArticulo()+\" que pertence al servicio \"+myArticulo.getArticulo()+\" ,\\nno tiene existencia en \"+ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getDescripcion(),\"Error en existencia\",JOptionPane.ERROR_MESSAGE);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}//sin del for que recore los insumos\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//se comprueba que todos los insumos tienen exitencia para agregar el servicio a la factura\r\n\t\t\t\t\t\t\t\t\t\t\tif(exist){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//activar para redondiar el precio de venta final\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPrecioRedondear()){\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmyArticulo.setPrecioVenta((int) Math.round(myArticulo.getPrecioVenta()));\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t//se establece la cantidad al item\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setCantidad(cantidadSaldoItem);\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t\tJOptionPane.showMessageDialog(view, \"No se puede requerir la cantidad de \"+cantidadSaldoItem.setScale(0, BigDecimal.ROUND_HALF_EVEN).doubleValue()+\" del articulo en la bodega \"+ConexionStatic.getUsuarioLogin().getCajaActiva().getDetartamento().getDescripcion());\r\n\t\t\t\t\t\t\t\t\t\t\t\tview.getModeloTabla().eliminarDetalle(filaPulsada);\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}else{//sino tiene insumos el servicio se agrega directamente a la factura\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//se establece la cantidad al item\r\n\t\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).setCantidad(cantidadSaldoItem);\r\n\t\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}//fin de la comprobacion que la estrada es un numero\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F10:\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F11:\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_F12:\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase  KeyEvent.VK_ESCAPE:\r\n\t\t\t\t\t\tsalir();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_DELETE:\r\n\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t this.view.getModeloTabla().eliminarDetalle(filaPulsada);\r\n\t\t\t\t\t\t\t this.calcularTotales();\r\n\t\t\t\t\t\t }\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase KeyEvent.VK_DOWN:\r\n\t\t\t\t\t\tthis.netBuscar++;\r\n\t\t\t\t\t//\tthis.buscarMasOmenos(netBuscar);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyEvent.VK_UP:\r\n\t\t\t\t\t\tif(netBuscar>=1){\r\n\t\t\t\t\t\t\tthis.netBuscar--;\r\n\t\t\t\t\t//\t\tthis.buscarMasOmenos(netBuscar);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyEvent.VK_LEFT:\r\n\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPwdEntrePrecio()){\r\n\t\t\t\t\t\t\tString pwd=getPassword();\r\n\t\t\t\t\t\t\tif(pwd!=null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//comprabacion del permiso administrativo\r\n\t\t\t\t\t\t\t\tif(myUsuarioDao.comprobarAdmin(pwd)){\r\n\r\n\t\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).getArticulo().netPrecio();\r\n\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\tselectRowInset(filaPulsada);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).getArticulo().netPrecio();\r\n\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\tselectRowInset(filaPulsada);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyEvent.VK_RIGHT:\r\n\t\t\t\t\t\tif(ConexionStatic.getUsuarioLogin().getConfig().isPwdEntrePrecio()){\r\n\r\n\t\t\t\t\t\t\tString pwd=getPassword();\r\n\t\t\t\t\t\t\tif(pwd!=null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//comprabacion del permiso administrativo\r\n\t\t\t\t\t\t\t\tif(myUsuarioDao.comprobarAdmin(pwd)){\r\n\r\n\t\t\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).getArticulo().lastPrecio();\r\n\t\t\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\t\t\tselectRowInset(filaPulsada);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\r\n\r\n\t\t\t\t\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t\t\t\t\tthis.view.getModeloTabla().getDetalle(filaPulsada).getArticulo().lastPrecio();\r\n\t\t\t\t\t\t\t\tthis.calcularTotales();\r\n\t\t\t\t\t\t\t\tselectRowInset(filaPulsada);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t}\r\n\r\n\tpublic static String getPassword() {\r\n\t\tJPanel panel = new JPanel();\r\n\t\tfinal JPasswordField passwordField = new JPasswordField(10);\r\n\t\tpanel.add(new JLabel(\"Password\"));\r\n\t\tpanel.add(passwordField);\r\n\t\tJOptionPane pane = new JOptionPane(panel, JOptionPane.QUESTION_MESSAGE, JOptionPane.OK_CANCEL_OPTION) {\r\n\t\t\t@Override\r\n\t\t\tpublic void selectInitialValue() {\r\n\t\t\t\tpasswordField.requestFocusInWindow();\r\n\t\t\t}\r\n\t\t};\r\n\t\tpane.createDialog(null, \"Autorizacion\").setVisible(true);\r\n\t\treturn passwordField.getPassword().length == 0 ? null : new String(passwordField.getPassword());\r\n\t}\r\n\tprivate void selectRowInset(int row){\r\n\t\tint col = 1;\r\n\t\tboolean toggle = false;\r\n\t\tboolean extend = false;\r\n\t\tthis.view.getTableDetalle().changeSelection(row, 0, toggle, extend);\r\n\t\tthis.view.getTableDetalle().changeSelection(row, col, toggle, extend);\r\n\t\tthis.view.getTableDetalle().addColumnSelectionInterval(0, 6);\r\n\r\n\t}\r\n\t\r\n\tpublic void cargarFacturasPendientes(List<Factura> facturas){\r\n\t\t\r\n\t\t\r\n\t\tif(facturas!=null){\r\n\t\t\tfor(int c=0;c<facturas.size();c++){\r\n\t\t\t\tthis.view.addBotonPendiente(facturas.get(c),this);\r\n\t\t\t\t//view.conectarBtnContralador();\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tview.eliminarBotones();\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tprivate void showPendientes() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tViewListaCotizacion vistaFacturars=new ViewListaCotizacion(this.view);\r\n\t\tCtlCotizacionLista ctlFacturas=new CtlCotizacionLista(vistaFacturars );\r\n\t\t\r\n\t\tvistaFacturars.pack();\r\n\t\t\r\n\t\tboolean resul=ctlFacturas.buscarCotizaciones(view);\r\n\t\t\r\n\t\tif(resul){\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tthis.myFactura=ctlFacturas.getMyFactura();\r\n\t\t\tcargarFacturaView();\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t//myArticulo=null;\r\n\t\tvistaFacturars.dispose();\r\n\t\tctlFacturas=null;\r\n\t\tvistaFacturars.dispose();\r\n\t\tctlFacturas=null;\r\n\t}\r\n\t\r\n\t\r\n\tprivate void cierreCaja() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t@Override\r\n\tpublic void keyReleased(KeyEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t\t\r\n\t\tif(e.getComponent()==this.view.getTxtNombrecliente()){\r\n\t\t\tview.getTxtIdcliente().setText(\"-1\");\r\n\t\t\tthis.myCliente=null;\r\n\t\t\t\r\n\t\t}\r\n\t\t//para dejar la view para una nueva factura\r\n\t\tif(e.isControlDown() && e.getKeyCode() == KeyEvent.VK_N){\r\n\t\t\tsetEmptyView();\r\n\t\t}\r\n\t\t\r\n\t\t//para actulizar factura\r\n\t\t\t\tif(e.isControlDown() && e.getKeyCode() == KeyEvent.VK_A){\r\n\t\t\t\t\t\tif(view.getBtnActualizar().isEnabled())\r\n\t\t\t\t\t\t\tactualizar();\r\n\t\t\t\t\t}\r\n\t\t\t\t//para guardar factura\r\n\t\t\t\tif(e.isControlDown() && e.getKeyCode() == KeyEvent.VK_G){\r\n\t\t\t\t\t\tif(view.getBtnGuardar().isEnabled())\r\n\t\t\t\t\t\t\tguardar();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t//para dejar la view para una nueva factura\r\n\t\t\t\tif(e.isControlDown() && e.getKeyCode() == KeyEvent.VK_N){\r\n\t\t\t\t\tsetEmptyView();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (e.isControlDown() && e.getKeyCode() == KeyEvent.VK_P) {\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\r\n\t\t        }\r\n\t\t//Recoger que fila se ha pulsadao en la tabla\r\n\t\tfilaPulsada = this.view.getTableDetalle().getSelectedRow();\r\n\t\tchar caracter = e.getKeyChar();\r\n\t\t\r\n\t\t\r\n\t\t//para quitar los simnos mas o numero que ingrese en la busqueda\r\n\t\tif(e.getComponent()==this.view.getTxtBuscar()){\r\n\t\t\tCharacter caracter1 = new Character(e.getKeyChar());\r\n\t        if (!esValido(caracter1))\r\n\t        {\r\n\t           String texto = \"\";\r\n\t           for (int i = 0; i < view.getTxtBuscar().getText().length(); i++)\r\n\t                if (esValido(new Character(view.getTxtBuscar().getText().charAt(i))))\r\n\t                    texto += view.getTxtBuscar().getText().charAt(i);\r\n\t           \t\t\tview.getTxtBuscar().setText(texto);\r\n\t                //view.getToolkit().beep();\r\n\t        }\r\n\t\t}\r\n\t\t/*\r\n\t//que no se la fecha de arriba y abajo\r\n\tif(e.getKeyCode()!=KeyEvent.VK_DOWN && e.getKeyCode()!= KeyEvent.VK_UP && e.getKeyCode()!= KeyEvent.VK_ENTER)\r\n\t\t\r\n\t\t//se comprueba que hay algo que buscar\r\n\t\tif(e.getComponent()==this.view.getTxtBuscar()&&view.getTxtBuscar().getText().trim().length()!=0){\r\n\t\t\t\r\n\t\t\tmyArticuloDao=new ArticuloDao(conexion);\r\n\t\t\t//JOptionPane.showMessageDialog(view, \"2\");\r\n\t\t\t//JOptionPane.showMessageDialog(view, view.getTxtBuscar().getText());\r\n\t\t\tthis.myArticulo=this.myArticuloDao.buscarArticuloNombre(view.getTxtBuscar().getText());\r\n\t\t\t\r\n\t\t\t//JOptionPane.showMessageDialog(view, myArticulo);\r\n\t\t\tif(myArticulo!=null){\r\n\t\t\t\tview.getTxtArticulo().setText(myArticulo.getArticulo());\r\n\t\t\t\tview.getTxtPrecio().setText(\"L. \"+myArticulo.getPrecioVenta());\r\n\t\t\t\tnetBuscar=0;\r\n\t\t\t\tnetBuscar++;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tmyArticulo=null;\r\n\t\t\t\tview.getTxtArticulo().setText(\"\");\r\n\t\t\t\tview.getTxtPrecio().setText(\"\");\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\tmyArticulo=null;\r\n\t\t\tview.getTxtArticulo().setText(\"\");\r\n\t\t\tview.getTxtPrecio().setText(\"\");\r\n\t\t}\r\n\t\t*/\r\n\t\t\r\n\t\tif(caracter=='+'){\r\n\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t//JOptionPane.showMessageDialog(view,e.getKeyChar()+\" FIla:\"+filaPulsada);\r\n\t\t\t\tthis.view.getModeloTabla().masCantidad(filaPulsada);\r\n\t\t\t\t//JOptionPane.showMessageDialog(view,view.getModeloTabla().getDetalle(filaPulsada).getCantidad());\r\n\t\t\t\tthis.calcularTotales();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(caracter=='-'){\r\n\t\t\tif(filaPulsada>=0){\r\n\t\t\t\t//JOptionPane.showMessageDialog(view,e.getKeyChar()+\" FIla:\"+filaPulsada);\r\n\t\t\t\tthis.view.getModeloTabla().restarCantidad(filaPulsada);\r\n\t\t\t\t//JOptionPane.showMessageDialog(view,view.getModeloTabla().getDetalle(filaPulsada).getCantidad());\r\n\t\t\t\tthis.calcularTotales();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t/*\t\r\n\tprivate void buscarMasOmenos(int p){\r\n\t\t//se comprueba que hay algo que buscar\r\n\t\t\t\tif(view.getTxtBuscar().getText().trim().length()!=0){\r\n\t\t\t\t\t\r\n\t\t\t\t\tmyArticuloDao=new ArticuloDao(conexion);\r\n\t\t\t\t\t//JOptionPane.showMessageDialog(view, \"2\");\r\n\t\t\t\t\t//JOptionPane.showMessageDialog(view, view.getTxtBuscar().getText());\r\n\t\t\t\t\tthis.myArticulo=this.myArticuloDao.buscarArticuloNombre(view.getTxtBuscar().getText(),p);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//JOptionPane.showMessageDialog(view, myArticulo);\r\n\t\t\t\t\tif(myArticulo!=null){\r\n\t\t\t\t\t\tview.getTxtArticulo().setText(myArticulo.getArticulo());\r\n\t\t\t\t\t\tview.getTxtPrecio().setText(\"L. \"+myArticulo.getPrecioVenta());\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tmyArticulo=null;\r\n\t\t\t\t\t\tview.getTxtArticulo().setText(\"\");\r\n\t\t\t\t\t\tview.getTxtPrecio().setText(\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tmyArticulo=null;\r\n\t\t\t\t\tview.getTxtArticulo().setText(\"\");\r\n\t\t\t\t\tview.getTxtPrecio().setText(\"\");\r\n\t\t\t\t}\r\n\t}*/\r\n\t\r\n\tprivate void salir(){\r\n\t\tthis.view.setVisible(false);\r\n\t\t\r\n\t\t\r\n\t}\r\n\tprivate void guardar(){\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tsetFactura();\r\n\t\tboolean resultado=facturaOrdenesDao.registrar(myFactura);\r\n\t\t\r\n\t\tif(resultado){\r\n\t\t\tmyFactura.setIdFactura(facturaDao.getIdFacturaGuardada());\r\n\t\t\tresultado=true;\r\n\t\t\t\r\n\t\t\tthis.tipoView=1;\r\n\t\t\t//this.view.setVisible(false);\r\n\t\t\t//view.addBotonPendiente(myFactura,this);\r\n\t\t\t\r\n\t\t\tsetEmptyView();\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tview.getBtnsGuardador().deleteAll();\r\n\t\t\t\r\n\t\t\tcargarFacturasPendientes(facturaOrdenesDao.facturasEnProceso());\r\n\t\t}else{\r\n\t\t\tJOptionPane.showMessageDialog(view, \"Error al guardar la factura temporal\", \"Error al guardar\", JOptionPane.ERROR_MESSAGE);\r\n\t\t}\r\n\t\t\r\n\t\r\n\t\t\r\n\t}\r\n\tprivate void actualizar() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tsetFactura();\r\n\t\tfacturaOrdenesDao.actualizar(myFactura);\r\n\t\t//this.view.setVisible(false);\r\n\t\t//giu\r\n\t\tthis.tipoView=1;\r\n\t\tthis.view.getBtnGuardar().setEnabled(true);\r\n\t\tthis.view.getBtnActualizar().setEnabled(false);\r\n\t\t\r\n\t\t//view.getBtnsGuardador().setFactura(myFactura);\r\n\t\t\r\n\t\tsetEmptyView();\r\n\t\t\r\n\t\tview.getBtnsGuardador().deleteAll();\r\n\t\t\r\n\t\tcargarFacturasPendientes(facturaOrdenesDao.facturasEnProceso());\r\n\t\t\r\n\t\t//view.addBotonPendiente(myFactura,this);\r\n\t\t\r\n\t}\r\n\tprivate boolean validar(){\r\n\t\tboolean resultado=false;\r\n\t\tif(!(view.getModeloTabla().getRowCount()>1)){\r\n\t\t\tJOptionPane.showMessageDialog(view, \" Debe agregar articulos primero.\",\"Error Validacion\",JOptionPane.ERROR_MESSAGE);\r\n\t\t\tresultado=false;\r\n\t\t}\r\n\t\telse if(this.myCliente==null){\r\n\t\t\t\r\n\t\t\t//JOptionPane.showMessageDialog(view, \"Debe agregar el cliente primero\");\r\n\t\t\tJOptionPane.showMessageDialog(view, \"Debe agregar el cliente primero\", \"Error Validacion\", JOptionPane.ERROR_MESSAGE);\r\n\t\t\tresultado=false;\r\n\t\t\t\r\n\t\t}else{\r\n\t\t\tresultado=true;\r\n\t\t}\r\n\t\treturn resultado;\r\n\t}\r\n\tprivate void cobrar(){\r\n\t\t\r\n\t\t\r\n\t}\r\n\tprivate void buscarArticulo(){\r\n\t\r\n\t\t//se llama el metodo que mostrar la ventana para buscar el articulo\r\n\t\tViewListaArticulo viewListaArticulo=new ViewListaArticulo(view);\r\n\t\tCtlArticuloBuscar ctlArticulo=new CtlArticuloBuscar(viewListaArticulo);\r\n\t\t\r\n\t\tviewListaArticulo.pack();\r\n\t\tctlArticulo.view.getTxtBuscar().setText(\"\");\r\n\t\tctlArticulo.view.getTxtBuscar().selectAll();\r\n\t\tview.getTxtBuscar().requestFocusInWindow();\r\n\t\tviewListaArticulo.conectarControladorBuscar(ctlArticulo);\r\n\t\t\r\n\t\tboolean resul=ctlArticulo.buscarArticulo(view);\r\n\t\t\r\n\t\tif(resul){\r\n\t\t\t\r\n\t\t\tmyArticulo=ctlArticulo.getArticulo();\r\n\t\t\t//myArticulo=myArticulo1;\r\n\t\t\tpreciosDao=new PrecioArticuloDao();\r\n\t\t\t\r\n\t\t\tmyArticulo.setPreciosVenta(this.preciosDao.getPreciosArticulo(myArticulo.getId()));\r\n\t\t\tmyArticulo.setCodigoBarra(codBarraDao.getCodArticulo(myArticulo.getId()));\r\n\t\t\t\r\n\t\t\tthis.view.getModeloTabla().setArticulo(myArticulo);\r\n\t\t\t//this.view.getModelo().getDetalle(row).setCantidad(1);\r\n\t\t\t\r\n\t\t\t//calcularTotal(this.view.getModeloTabla().getDetalle(row));\r\n\t\t\tcalcularTotales();\r\n\t\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\t\t\r\n\t\t\tselectRowInset();\r\n\t\t}\r\n\t\t\r\n\t\t//myArticulo=null;\r\n\t\tviewListaArticulo.dispose();\r\n\t\tctlArticulo=null;\r\n\t\t\r\n\t}\r\n\tprivate void setEmptyView(){\r\n\t\t//se estable la tabla de detalles vacia\r\n\t\tview.getModeloTabla().setEmptyDetalles();\r\n\t\t\r\n\t\tmyFactura.setCodigoAlter(0);\r\n\t\t//se agrega una fila vacia a la tabla detalle\r\n\t\tview.getModeloTabla().agregarDetalle();\r\n\t\t\r\n\t\t\r\n\t\t//conseguir la fecha la facturaa\r\n\t\tview.getTxtFechafactura().setText(facturaDao.getFechaSistema());\r\n\t\t\r\n\t\t//se estable un cliente generico para la factura\r\n\t\tthis.view.getTxtIdcliente().setText(\"1\");\r\n\t\tthis.view.getTxtNombrecliente().setText(\"Consumidor final\");\r\n\t\tview.getTxtRtn().setText(\"\");\r\n\t\t\r\n\t\t\r\n\t\tthis.myCliente=null;\r\n\t\tthis.myArticulo=null;\r\n\t\t\r\n\t\t//this.view.getTxtArticulo().setText(\"\");\r\n\t\tthis.view.getTxtBuscar().setText(\"\");\r\n\t\tthis.view.getTxtDescuento().setText(\"\");\r\n\t\tthis.view.getTxtImpuesto().setText(\"0.00\");\r\n\t\tthis.view.getTxtImpuesto18().setText(\"0.00\");\r\n\t\t//this.view.getTxtPrecio().setText(\"0.00\");\r\n\t\tthis.view.getTxtSubtotal().setText(\"0.00\");\r\n\t\tthis.view.getTxtTotal().setText(\"0.00\");\r\n\t\tthis.myFactura.setObservacion(\"\");\r\n\t\tthis.view.getRdbtnContado().setSelected(true);\r\n\t\t\r\n\t\t//se estable el focus de la view en la caja de texto buscar\r\n\t\tthis.view.getTxtBuscar().requestFocusInWindow();\r\n\t\t\r\n\t}\r\n\tprivate void buscarCliente(){\r\n\t\t//se crea la vista para buscar los cliente\r\n\t\tViewListaClientes viewListaCliente=new ViewListaClientes (this.view);\r\n\t\t\r\n\t\tCtlClienteBuscar ctlBuscarCliente=new CtlClienteBuscar(viewListaCliente);\r\n\t\t\r\n\t\tboolean resul=ctlBuscarCliente.buscarCliente(view);\r\n\t\t//se comprueba si le regreso un articulo valido\r\n\t\tif(resul){\r\n\t\t\t\r\n\t\t\tmyCliente=ctlBuscarCliente.getCliente();\r\n\t\t\tthis.view.getTxtIdcliente().setText(\"\"+myCliente.getId());\r\n            this.view.getTxtNombrecliente().setText(myCliente.getNombre());\r\n\t\t\tthis.view.getTxtRtn().setText(myCliente.getRtn());\r\n\t\t\r\n\t\t}else{\r\n\t\t\t//JOptionPane.showMessageDialog(view, \"No se encontro el cliente\");\r\n\t\t\tthis.view.getTxtIdcliente().setText(\"1\");\r\n            this.view.getTxtNombrecliente().setText(\"Consumidor final\");\r\n\t\t\r\n\t\t}\r\n\t\tviewListaCliente.dispose();\r\n\t\tctlBuscarCliente=null;\r\n\t}\r\n\t\r\n\t\r\npublic void guardarLocal(){\r\n\t\r\n\t\t\r\n\t}\r\n\r\npublic void guardarRemoto(){\r\n\r\n\t}\r\n\r\n\r\n\r\n\t\r\n\t\r\n\tprivate void selectRowInset(){\r\n\t\t\r\n\t\tint row = this.view.getTableDetalle().getRowCount () - 2;\r\n\t    int col = 1;\r\n\t    boolean toggle = false;\r\n\t    boolean extend = false;\r\n\t    this.view.getTableDetalle().changeSelection(row, 0, toggle, extend);\r\n\t    this.view.getTableDetalle().changeSelection(row, col, toggle, extend);\r\n\t    this.view.getTableDetalle().addColumnSelectionInterval(0, 6);\r\n\t\t\r\n\t\t/*<<<<<<<<<<<<<<<selecionar la ultima fila creada>>>>>>>>>>>>>>>*/\r\n\t\t/*int row =  this.view.geTableDetalle().getRowCount () - 2;\r\n\t\tJOptionPane.showMessageDialog(view, row);\r\n\t\t/Rectangle rect = this.view.geTableDetalle().getCellRect(row, 0, true);\r\n\t\tthis.view.geTableDetalle().scrollRectToVisible(rect);\r\n\t\tthis.view.geTableDetalle().clearSelection();*/\r\n\t\t//this.view.geTableDetalle().setRowSelectionInterval(row, row);\r\n\t\t//view.geTableDetalle().setRowSelectionInterval(row, row);\r\n\t\t//view.geTableDetalle().clearSelection();\r\n\t\t//view.geTableDetalle().addRowSelectionInterval(row,row);\r\n\t\t//TablaModeloFactura modelo = (TablaModeloFactura)this.view.geTableDetalle().getModel();\r\n\t\t//modelo.fireTableDataChanged();\r\n\t\t//this.view.getModeloTabla().fireTableDataChanged();\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowOpened(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowClosing(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t//facturaDao.desconectarBD();\r\n\t\t//this.clienteDao.desconectarBD();\r\n\t\t//this.myArticuloDao.desconectarBD();\r\n\t\t//this.myFactura.setIdFactura(-1);\r\n\t\tthis.view.setVisible(false);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowClosed(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowIconified(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowDeiconified(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowActivated(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void windowDeactivated(WindowEvent e) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic void cargarFacturaView(){\r\n\t\t\r\n\t\tthis.view.getTxtIdcliente().setText(\"\"+myFactura.getCliente().getId());\r\n        this.view.getTxtNombrecliente().setText(myFactura.getCliente().getNombre());\r\n\t\tview.getTxtRtn().setText(myFactura.getCliente().getRtn());\r\n\t\t\r\n\t\t//se establece el total e impuesto en el vista\r\n\t\tthis.view.getTxtTotal().setText(\"\"+myFactura.getTotal().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\tthis.view.getTxtImpuesto().setText(\"\"+myFactura.getTotalImpuesto().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\tthis.view.getTxtSubtotal().setText(\"\"+myFactura.getSubTotal().setScale(2, BigDecimal.ROUND_HALF_EVEN));\r\n\t\t\r\n\t\tthis.view.getModeloTabla().setDetalles(myFactura.getDetalles());\r\n\t}\r\n\r\n\r\n\tpublic Factura actualizarFactura(Factura f) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tthis.myFactura=f;\r\n\t\tcargarFacturaView();\r\n\t\tthis.view.getBtnGuardar().setVisible(false);\r\n\t\tthis.view.getBtnActualizar().setVisible(true);\r\n\t\tthis.view.getModeloTabla().agregarDetalle();\r\n\t\ttipoView=2;\r\n\t\tthis.view.setVisible(true);\r\n\t\t\r\n\t\t//para controlar que es una actualizacion la que se hace\r\n\t\t\r\n\t\t\r\n\t\treturn myFactura;\r\n\t\t\r\n\t}\r\n\r\n\r\n\tpublic boolean getAccion() {\r\n\t\tview.setVisible(true);\r\n\t\treturn resultado;\r\n\t}\r\n\r\n\r\n\tpublic void viewFactura(Factura f) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tthis.myFactura=f;\r\n\t\tcargarFacturaView();\r\n\t\tthis.view.getPanelAcciones().setVisible(false);\r\n\t\tthis.view.setVisible(true);\r\n\t}\r\n\r\n\r\n\tpublic Factura getFactura() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn this.myFactura;\r\n\t}\r\n\t\r\n\tprivate boolean setCierre() {\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/net/datatecsolution/admin_tools/controlador/CtlOrdenVenta.java b/src/main/java/net/datatecsolution/admin_tools/controlador/CtlOrdenVenta.java
--- a/src/main/java/net/datatecsolution/admin_tools/controlador/CtlOrdenVenta.java	
+++ b/src/main/java/net/datatecsolution/admin_tools/controlador/CtlOrdenVenta.java	
@@ -1482,6 +1482,13 @@
 		
 		
 		setFactura();
+
+		ViewCargarVenderor viewVendedor=new ViewCargarVenderor(null);
+		CtlCargarVendedor ctlVendedor=new CtlCargarVendedor(viewVendedor);
+
+		ctlVendedor.cargarVendedor();
+		myFactura.setVendedor(ctlVendedor.getVendetor());//activas para cuando se necesite un vendedor
+
 		boolean resultado=facturaOrdenesDao.registrar(myFactura);
 		
 		if(resultado){
Index: src/main/java/net/datatecsolution/admin_tools/modelo/ConexionStatic.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\n\r\npackage net.datatecsolution.admin_tools.modelo;\r\n\r\nimport org.apache.commons.dbcp2.BasicDataSource;\r\n\r\n\r\nimport javax.net.ssl.HttpsURLConnection;\r\nimport javax.sql.DataSource;\r\nimport javax.swing.*;\r\nimport java.net.URL;\r\nimport java.sql.Connection;\r\nimport java.sql.PreparedStatement;\r\nimport java.sql.SQLException;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Clase que permite conectar con la base de datos\r\n * @author jdmayorga\r\n *\r\n */\r\npublic abstract class ConexionStatic implements Runnable{\r\n\r\n\r\n\r\n\tprivate static String bd = \"admin_tools\";\r\n\r\n/*\r\n\t//LOCAL_PRODUCCION\r\n\tprivate static String login = \"admin\";\r\n\t//private static String login = \"root\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"127.0.0.1\";\r\n\t//private static String server = \"192.168.1.4\";\r\n/*\r\n\r\n\r\n/*\r\n\r\n\t//LOCALHOST\r\n\tprivate static String login = \"root\";\r\n\tprivate static String password = \"Jdmm123.\";\r\n\tprivate static String server = \"127.0.0.1\";\r\n\r\n/*\r\n\r\n\t//Tienda el picacho\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"192.168.88.253\";\r\n\r\n\r\n\t//Supermercado Erlin\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"192.168.89.250\";\r\n\r\n\r\n/*\r\n    //AutoRepuesto Escobar\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123.\";\r\n\tprivate static String server = \"127.0.0.1\";\r\n\t//private static String server = \"192.168.1.4\";\r\n\r\n\r\n\r\n\t//Joyeria Guayape\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\t//private static String server = \"127.0.0.1\";\r\n\tprivate static String server = \"192.168.1.3\";\r\n\r\n\r\n\r\n\t//San Jose Super\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\t//private static String server = \"192.168.5.2\";\r\n\tprivate static String server = \"192.168.1.4\";\r\n\r\n */\r\n/*\r\n\r\n\t//Samuel ferreteria\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"192.168.89.250\";\r\n\t//private static String server = \"192.168.1.4\";\r\n\r\n\r\n/*\r\n\t//Comercial velasquez\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"192.168.100.110\";\r\n*/\r\n\t//Farmacia San Ramon\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"192.168.88.254\";\r\n\t//private static String server = \"192.168.1.3\";\r\n/*\r\n\r\n\t//NARANJAL\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123?\";\r\n\tprivate static String server = \"192.168.1.101\";\r\n\r\n\r\n\r\n\t//CLINICA PALMA\r\n\tprivate static String login = \"user_admin\";\r\n\tprivate static String password = \"Jdmm1234.\";\r\n\tprivate static String server = \"192.168.1.10\";\r\n\r\n\r\n\r\n\r\n\r\n\t//DISTRIBUIDORA SHAROM\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"ronLsnta123.\";\r\n\tprivate static String server = \"192.168.10.102\";\r\n\r\n/*\r\n\t//MISCELANIAS W&C\r\n\tprivate static String login = \"user_pos\";\r\n\tprivate static String password = \"Admin123.\";\r\n\tprivate static String server = \"192.168.1.25\";\r\n\r\n\r\n\r\n\t//FERROCENTER           \r\n\tprivate static String login = \"user_admin\";\r\n\tprivate static String password = \"Jdmm123.\";\r\n\tprivate static String server = \"192.168.1.2\";\r\n\r\n\r\n/*\r\n\r\n\t//TEXACO OLANCHITO\r\n\tprivate static String login = \"admin\";\r\n\tprivate static String password = \"Jdmm123.\";\r\n\tprivate static String server = \"10.10.10.8\";\r\n\r\n\r\n\r\n\t//LA GRANJA\r\n\tprivate static String login = \"admin_tools_user\";\r\n\tprivate static String password = \"Jdmm123.\";\r\n\t//private static String server = \"192.168.0.110\";\r\n\tprivate static String server = \"192.168.1.4\";\r\n\r\n*/\r\n\r\n\r\n\r\n\tprivate static String url = \"jdbc:mysql://\"+server+\":3306/\"+bd+\"?serverTimezone=GMT-6\";\r\n\tprivate static String driver=\"com.mysql.cj.jdbc.Driver\";\r\n\r\n\r\n\r\n\tprivate static Usuario usuarioLogin = null;\r\n\r\n\r\n\tprivate static DataSource poolConexiones = null;\r\n\r\n\r\n\tprivate static boolean nivelFac = false;\r\n\r\n\r\n\tpublic static void setNivelFac(boolean n) {\r\n\t\tnivelFac = n;\r\n\t}\r\n\r\n\tpublic static void conectarBD() {\r\n\t\tpoolConexiones = setDataSource(\"mysql\");\r\n\r\n\t}\r\n\r\n\r\n\tpublic static boolean getNivelFact() {\r\n\t\treturn ConexionStatic.nivelFac;\r\n\t}\r\n\r\n\tpublic static Usuario getUsuarioLogin() {\r\n\t\treturn ConexionStatic.usuarioLogin;\r\n\t}\r\n\r\n\tpublic static void setUsuarioLogin(Usuario u) {\r\n\t\tConexionStatic.usuarioLogin = u;\r\n\r\n\t}\r\n\r\n\r\n\tpublic static DataSource getPoolConexion() {\r\n\t\treturn ConexionStatic.poolConexiones;\r\n\t}\r\n\r\n\r\n\tpublic void setUsuario(Usuario u) {\r\n\t\tConexionStatic.usuarioLogin = u;\r\n\t}\r\n\r\n\tpublic boolean getConnectionStatus() {\r\n\t\tboolean conStatus = false;\r\n\t\ttry {\r\n\t\t\tURL u = new URL(\"https://www.google.com/\");\r\n\t\t\tHttpsURLConnection huc = (HttpsURLConnection) u.openConnection();\r\n\t\t\thuc.connect();\r\n\t\t\tconStatus = true;\r\n\t\t} catch (Exception e) {\r\n\t\t\tconStatus = false;\r\n\t\t}\r\n\t\treturn conStatus;\r\n\t}\r\n\r\n\tpublic static boolean isDbConnected() {\r\n\t\tfinal String CHECK_SQL_QUERY = \"SELECT 1\";\r\n\t\tConnection con = null;\r\n\t\tPreparedStatement statement = null;\r\n\r\n\t\tboolean isConnected = false;\r\n\r\n\t\ttry {\r\n\t\t\tcon = getPoolConexion().getConnection();\r\n\t\t\tstatement = con.prepareStatement(CHECK_SQL_QUERY);\r\n\t\t\tstatement.executeQuery();\r\n\t\t\tisConnected = true;\r\n\t\t} catch (SQLException | NullPointerException e) {\r\n\t\t\t// handle SQL error here!\r\n\t\t\te.printStackTrace();\r\n\t\t\tJOptionPane.showMessageDialog(null, \"No se pudo estrablecer una conexion con la base datos.\", \"Error de conexion.\", JOptionPane.ERROR_MESSAGE);\r\n\t\t} finally {\r\n\t\t\ttry {\r\n\t\t\t\t//\tif(res != null) res.close();\r\n\t\t\t\tif (statement != null) statement.close();\r\n\t\t\t\tif (con != null) con.close();\r\n\r\n\t\t\t} // fin de try\r\n\t\t\tcatch (SQLException excepcionSql) {\r\n\t\t\t\texcepcionSql.printStackTrace();\r\n\t\t\t\t//conexion.desconectar();\r\n\t\t\t} // fin de catch\r\n\t\t}\r\n\t\treturn isConnected;\r\n\t}\r\n\r\n\r\n\tprivate static DataSource setDataSource(String dbType) {\r\n\r\n\t\tBasicDataSource ds = new BasicDataSource();\r\n\r\n\t\t/*\r\n\t\tProperties props = new Properties();\r\n\t\t// File file = new File(\"/config/db.config\");\r\n\t\tInputStream file = null;\r\n\t\tFileInputStream fis = null;\r\n\t\t//InputStream fis=null;\r\n\r\n\t\t//fis=new FileInputStream(file);\r\n\t\tfile = net.datatecsolution.Principal.class.getResourceAsStream(\"/config/db.config\");\r\n\r\n\t\ttry {\r\n\t\t\tprops.load(file);\r\n\t\t} catch (IOException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\r\n\t\t */\r\n\r\n\t\tif (\"mysql\".equals(dbType)) {\r\n\r\n\t\t\t/*\r\n\t\t\tds.setDriverClassName(props.getProperty(\"MYSQL_DB_DRIVER_CLASS\"));\r\n\r\n\t\t\tds.setUrl(\"jdbc:mysql://\" + props.getProperty(\"MYSQL_DB_URL\") + \":3306/\");\r\n\t\t\tds.setDefaultCatalog(props.getProperty(\"MYSQL_DB\"));\r\n\t\t\tds.setUsername(props.getProperty(\"MYSQL_DB_USERNAME\"));\r\n\t\t\tds.setPassword(props.getProperty(\"MYSQL_DB_PASSWORD\"));\r\n\r\n\t\t\t */\r\n\r\n           ds.setDriverClassName(driver);\r\n           ds.setUrl(url);\r\n           ds.setUsername(login);\r\n           ds.setPassword(password);\r\n\t\t\t// ds.setMinIdle(20);\r\n\t\t\t//ds.setMaxActive(3);\r\n\t\t\tds.setMaxIdle(3);\r\n\t\t\tds.setMinIdle(3);\r\n\t\t\tds.setInitialSize(3);\r\n\r\n\r\n\t\t\tds.setInitialSize(3);\r\n\t\t\tds.setValidationQuery(\"select 1;\");\r\n\t\t\t//maxWait = 180000\r\n\r\n\t\t\t//ds.setMaxWait(-1);\r\n\t\t\t// minEvictableIdleTimeMillis = 1000 * 60 * 15\r\n\r\n\t\t\tds.setMinEvictableIdleTimeMillis(1000 * 60 * 15);\r\n\r\n\t\t\t// timeBetweenEvictionRunsMillis = 1000 * 60 * 15\r\n\t\t\tds.setTimeBetweenEvictionRunsMillis(1000 * 60 * 15);\r\n\t\t\t// numTestsPerEvictionRun = 3\r\n\t\t\tds.setNumTestsPerEvictionRun(1);\r\n\t\t\t// testOnBorrow = true\r\n\t\t\tds.setTestOnBorrow(true);\r\n\t\t\t// testWhileIdle = true\r\n\t\t\tds.setTestWhileIdle(true);\r\n\t\t\t// testOnReturn = false\r\n\r\n\t\t\tds.setTestOnReturn(true);\r\n\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn ds;\r\n\t}\r\n}\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/net/datatecsolution/admin_tools/modelo/ConexionStatic.java b/src/main/java/net/datatecsolution/admin_tools/modelo/ConexionStatic.java
--- a/src/main/java/net/datatecsolution/admin_tools/modelo/ConexionStatic.java	
+++ b/src/main/java/net/datatecsolution/admin_tools/modelo/ConexionStatic.java	
@@ -106,7 +106,7 @@
 	private static String server = "192.168.88.254";
 	//private static String server = "192.168.1.3";
 /*
-
+/*
 	//NARANJAL
 	private static String login = "admin";
 	private static String password = "Jdmm123?";
@@ -157,7 +157,7 @@
 	//private static String server = "192.168.0.110";
 	private static String server = "192.168.1.4";
 
-*/
+
 
 
 
